<!DOCTYPE html>
<html lang="ar" id="htmlElement">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battle Lands - Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #ff4655;
            --secondary-color: #0f1923;
            --accent-color: #1f2d3d;
            --gold-color: #ffd700;
            --text-color: #ffffff;
            --arabic-font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --english-font: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            background: radial-gradient(circle at center, #0a0a2e 0%, #000 100%);
            color: var(--text-color);
            font-family: var(--arabic-font);
            overflow: hidden;
            height: 100vh;
            position: relative;
        }

        /* Ø§Ù„Ù„ØºØ© */
        .language-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            gap: 10px;
        }

        .lang-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .lang-btn:hover {
            background: var(--primary-color);
            transform: scale(1.05);
        }

        .lang-btn.active {
            background: var(--primary-color);
            box-shadow: 0 0 20px var(--primary-color);
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f1923 0%, #1a1a2e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(20px);
        }

        .game-logo {
            font-size: 5em;
            background: linear-gradient(45deg, #ff4655, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 30px rgba(255, 70, 85, 0.5);
        }

        .player-name-input {
            width: 300px;
            padding: 15px;
            font-size: 1.2em;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            color: white;
            text-align: center;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }

        .player-name-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .start-game-btn {
            padding: 15px 40px;
            font-size: 1.3em;
            background: linear-gradient(45deg, #ff4655, #ff7b00);
            border: none;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
            font-weight: bold;
        }

        .start-game-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px #ff4655;
        }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .main-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1538481199705-c710c4e965fc?q=80&w=2065');
            background-size: cover;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9998;
        }

        .menu-overlay {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(15, 25, 35, 0.9);
            backdrop-filter: blur(5px);
        }

        .menu-content {
            position: relative;
            z-index: 2;
            text-align: center;
            max-width: 800px;
        }

        .menu-title {
            font-size: 4em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #ffd700, #ff4655);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(255, 70, 85, 0.3);
        }

        .player-welcome {
            font-size: 1.5em;
            color: #ffd700;
            margin-bottom: 40px;
        }

        .menu-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 40px;
        }

        .menu-option {
            background: linear-gradient(135deg, rgba(31, 45, 61, 0.8), rgba(15, 25, 35, 0.9));
            padding: 25px;
            border-radius: 15px;
            border: 2px solid var(--primary-color);
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .menu-option:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(255, 70, 85, 0.3);
            border-color: #ffd700;
        }

        .option-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: #ffd700;
        }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        .game-ui {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9997;
            display: none;
        }

        .player-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(15, 25, 35, 0.8);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid var(--primary-color);
            backdrop-filter: blur(10px);
            min-width: 200px;
        }

        .player-name-display {
            color: #ffd700;
            font-size: 1.3em;
            margin-bottom: 10px;
        }

        .health-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .health-bar {
            flex: 1;
            height: 20px;
            background: rgba(255, 70, 85, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .health-fill {
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, #ff4655, #00ff88);
            border-radius: 10px;
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .world-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(15, 25, 35, 0.8);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid #00a8ff;
            backdrop-filter: blur(10px);
            text-align: center;
            min-width: 150px;
        }

        .world-title {
            color: #00a8ff;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .world-level {
            color: #ffd700;
            font-size: 1.5em;
            font-weight: bold;
        }

        .game-stats {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 15px;
        }

        .stat-box {
            background: rgba(15, 25, 35, 0.8);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid;
            backdrop-filter: blur(10px);
            text-align: center;
            min-width: 120px;
        }

        .score-box { border-color: #ffd700; }
        .kills-box { border-color: #ff4655; }
        .weapons-box { border-color: #00a8ff; }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ø¬ÙˆØ§Ù„ */
        .mobile-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: none;
            gap: 15px;
            pointer-events: auto;
        }

        .control-btn {
            width: 70px;
            height: 70px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8em;
            color: white;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.1s;
        }

        .control-btn:active {
            transform: scale(0.9);
            background: rgba(255, 255, 255, 0.3);
        }

        /* Ø§Ù„ÙƒÙ†ÙØ§Ø³ */
        #gameCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            display: none;
        }

        /* Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø¹ÙˆØ§Ù„Ù… */
        .world-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            font-size: 3em;
            text-align: center;
            animation: transitionPulse 2s infinite;
        }

        @keyframes transitionPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Ø¨ÙˆØ³ Ø§Ù„Ø¹Ø§Ù„Ù… */
        .boss-fight {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            text-align: center;
        }

        .boss-title {
            font-size: 4em;
            color: #ff4655;
            margin-bottom: 20px;
            text-shadow: 0 0 30px #ff4655;
        }

        .boss-health {
            width: 80%;
            height: 40px;
            background: rgba(255, 70, 85, 0.3);
            border-radius: 20px;
            overflow: hidden;
            margin: 30px auto;
            border: 3px solid #ff4655;
        }

        .boss-health-fill {
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, #ff4655, #ff0000);
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ© -->
    <div class="language-selector">
        <button class="lang-btn active" onclick="changeLanguage('ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
        <button class="lang-btn" onclick="changeLanguage('en')">English</button>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="game-logo">âš”ï¸ Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„ âš”ï¸</div>
        <input type="text" class="player-name-input" id="playerNameInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§...">
        <button class="start-game-btn" onclick="savePlayerName()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©</button>
    </div>

    <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="main-menu" id="mainMenu">
        <div class="menu-overlay"></div>
        <div class="menu-content">
            <h1 class="menu-title" id="menuTitle">Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„</h1>
            <div class="player-welcome" id="playerWelcome">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="playerNameDisplay">Ø§Ù„Ù…Ø­Ø§Ø±Ø¨</span>!</div>
            <div class="menu-options">
                <div class="menu-option" onclick="startGame('pc')">
                    <div class="option-icon">ğŸ’»</div>
                    <div id="pcOption">Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±</div>
                </div>
                <div class="menu-option" onclick="startGame('mobile')">
                    <div class="option-icon">ğŸ“±</div>
                    <div id="mobileOption">Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ</div>
                </div>
                <div class="menu-option" onclick="showWeapons()">
                    <div class="option-icon">ğŸ—¡ï¸</div>
                    <div id="weaponsOption">Ø§Ù„Ø£Ø³Ù„Ø­Ø© (300)</div>
                </div>
                <div class="menu-option" onclick="showStats()">
                    <div class="option-icon">ğŸ†</div>
                    <div id="statsOption">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
    <div class="game-ui" id="gameUI">
        <div class="player-info">
            <div class="player-name-display" id="gamePlayerName">Ø§Ù„Ù…Ø­Ø§Ø±Ø¨</div>
            <div class="health-container">
                <span>â¤ï¸</span>
                <div class="health-bar">
                    <div class="health-fill" id="healthFill"></div>
                </div>
            </div>
        </div>

        <div class="world-info">
            <div class="world-title" id="worldTitle">Ø§Ù„Ø¹Ø§Ù„Ù…</div>
            <div class="world-level" id="worldLevel">1</div>
        </div>

        <div class="game-stats">
            <div class="stat-box score-box">
                <div class="stat-value" id="scoreValue">0</div>
                <div class="stat-label" id="scoreLabel">Ø§Ù„Ù†Ù‚Ø§Ø·</div>
            </div>
            <div class="stat-box kills-box">
                <div class="stat-value" id="killsValue">0</div>
                <div class="stat-label" id="killsLabel">Ø§Ù„Ù‚ØªÙ„Ù‰</div>
            </div>
            <div class="stat-box weapons-box">
                <div class="stat-value" id="weaponsValue">1</div>
                <div class="stat-label" id="weaponsLabel">Ø§Ù„Ø£Ø³Ù„Ø­Ø©</div>
            </div>
        </div>

        <div class="mobile-controls" id="mobileControls">
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div class="control-btn" id="leftBtn">â—€</div>
                <div class="control-btn" id="rightBtn">â–¶</div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div class="control-btn" id="jumpBtn">â¬†</div>
                <div class="control-btn" id="attackBtn">âš”</div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø¹ÙˆØ§Ù„Ù… -->
    <div class="world-transition" id="worldTransition">
        <div>
            <div id="transitionText">Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯...</div>
            <div style="font-size: 0.5em; margin-top: 20px;" id="transitionSubtext">Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø£ØµØ¨Ø­ÙˆØ§ Ø£Ù‚ÙˆÙ‰!</div>
        </div>
    </div>

    <!-- Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ -->
    <div class="boss-fight" id="bossFight">
        <div>
            <div class="boss-title" id="bossTitle">ğŸ‘¹ Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ğŸ‘¹</div>
            <div style="font-size: 1.5em; color: #ffd700; margin: 20px 0;" id="bossName">Ù…Ù„Ùƒ Ø§Ù„Ø¸Ù„Ø§Ù…</div>
            <div class="boss-health">
                <div class="boss-health-fill" id="bossHealthFill"></div>
            </div>
            <div style="font-size: 1.2em; color: #00a8ff;" id="bossInfo">Ø§Ø¶Ø±Ø¨ Ø¨Ù‚ÙˆØ© Ù„ØªÙ†ØªØµØ±!</div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <script>
        // ===== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„ØºØ© =====
        const translations = {
            ar: {
                gameTitle: "Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„",
                enterName: "Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§...",
                startGame: "ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©",
                welcome: "Ù…Ø±Ø­Ø¨Ø§Ù‹",
                pcOption: "Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±",
                mobileOption: "Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ",
                weaponsOption: "Ø§Ù„Ø£Ø³Ù„Ø­Ø© (300)",
                statsOption: "Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª",
                world: "Ø§Ù„Ø¹Ø§Ù„Ù…",
                score: "Ø§Ù„Ù†Ù‚Ø§Ø·",
                kills: "Ø§Ù„Ù‚ØªÙ„Ù‰",
                weapons: "Ø§Ù„Ø£Ø³Ù„Ø­Ø©",
                transition: "Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯...",
                transitionSub: "Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø£ØµØ¨Ø­ÙˆØ§ Ø£Ù‚ÙˆÙ‰!",
                bossTitle: "ğŸ‘¹ Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ğŸ‘¹",
                bossInfo: "Ø§Ø¶Ø±Ø¨ Ø¨Ù‚ÙˆØ© Ù„ØªÙ†ØªØµØ±!",
                gameOver: "Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!",
                restart: "ğŸ”„ Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰"
            },
            en: {
                gameTitle: "Battle Lands",
                enterName: "Enter your name here...",
                startGame: "ğŸš€ Start Adventure",
                welcome: "Welcome",
                pcOption: "Play on PC",
                mobileOption: "Play on Mobile",
                weaponsOption: "Weapons (300)",
                statsOption: "Statistics",
                world: "World",
                score: "Score",
                kills: "Kills",
                weapons: "Weapons",
                transition: "Transitioning to New World...",
                transitionSub: "Enemies have become stronger!",
                bossTitle: "ğŸ‘¹ Final Boss Battle ğŸ‘¹",
                bossInfo: "Strike hard to win!",
                gameOver: "Game Over!",
                restart: "ğŸ”„ Play Again"
            }
        };

        // ===== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let currentLanguage = 'ar';
        let playerName = "Ø§Ù„Ù…Ø­Ø§Ø±Ø¨";
        let gameActive = false;
        let deviceType = 'pc';
        let currentWorld = 1;
        let totalWorlds = 5;
        let bossActive = false;

        // ===== Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
        const playerStats = {
            score: 0,
            kills: 0,
            weaponsCollected: 1,
            health: 100,
            maxHealth: 100,
            currentWeapon: 0,
            worldKills: 0,
            killsNeededForNextWorld: 50
        };

        // ===== Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¹ÙˆØ§Ù„Ù… =====
        const worldNames = {
            1: { ar: "Ø¹Ø§Ù„Ù… Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©", en: "Starter World", color: "#00a8ff" },
            2: { ar: "Ø¹Ø§Ù„Ù… Ø§Ù„ØºØ§Ø¨Ø§Øª", en: "Forest World", color: "#00b894" },
            3: { ar: "Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ù„ÙŠØ¯", en: "Ice World", color: "#00cec9" },
            4: { ar: "Ø¹Ø§Ù„Ù… Ø§Ù„Ù†Ø§Ø±", en: "Fire World", color: "#ff7675" },
            5: { ar: "Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ", en: "Final World", color: "#a29bfe" }
        };

        // ===== 300 Ø³Ù„Ø§Ø­ =====
        const weapons = Array.from({ length: 300 }, (_, i) => ({
            id: i + 1,
            name: `Ø³Ù„Ø§Ø­ ${i + 1}`,
            damage: 10 + Math.floor(i / 10),
            rarity: Math.min(5, Math.floor(i / 60) + 1),
            color: getWeaponColor(Math.floor(i / 60))
        }));

        function getWeaponColor(tier) {
            const colors = ['#ffffff', '#4CAF50', '#2196F3', '#9C27B0', '#FF9800', '#FFD700'];
            return colors[Math.min(tier, colors.length - 1)];
        }

        // ===== ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© =====
        function changeLanguage(lang) {
            currentLanguage = lang;
            document.getElementById('htmlElement').setAttribute('lang', lang);
            document.getElementById('htmlElement').setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„ØºØ©
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateLanguage();
        }

        function updateLanguage() {
            const t = translations[currentLanguage];
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ
            document.querySelector('.game-logo').textContent = `âš”ï¸ ${t.gameTitle} âš”ï¸`;
            document.getElementById('playerNameInput').placeholder = t.enterName;
            document.querySelector('.start-game-btn').textContent = t.startGame;
            document.getElementById('menuTitle').textContent = t.gameTitle;
            document.getElementById('playerWelcome').textContent = `${t.welcome}ØŒ <span id="playerNameDisplay">${playerName}</span>!`;
            document.getElementById('pcOption').textContent = t.pcOption;
            document.getElementById('mobileOption').textContent = t.mobileOption;
            document.getElementById('weaponsOption').textContent = t.weaponsOption;
            document.getElementById('statsOption').textContent = t.statsOption;
            document.getElementById('worldTitle').textContent = t.world;
            document.getElementById('scoreLabel').textContent = t.score;
            document.getElementById('killsLabel').textContent = t.kills;
            document.getElementById('weaponsLabel').textContent = t.weapons;
            document.getElementById('transitionText').textContent = t.transition;
            document.getElementById('transitionSubtext').textContent = t.transitionSub;
            document.getElementById('bossTitle').textContent = t.bossTitle;
            document.getElementById('bossInfo').textContent = t.bossInfo;
        }

        // ===== Ø­ÙØ¸ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
        function savePlayerName() {
            const nameInput = document.getElementById('playerNameInput');
            playerName = nameInput.value.trim() || "Ø§Ù„Ù…Ø­Ø§Ø±Ø¨";
            
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'flex';
            document.getElementById('playerNameDisplay').textContent = playerName;
            document.getElementById('gamePlayerName').textContent = playerName;
        }

        // ===== Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function startGame(device) {
            deviceType = device;
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('gameCanvas').style.display = 'block';
            document.getElementById('gameUI').style.display = 'block';
            
            if (device === 'mobile') {
                document.getElementById('mobileControls').style.display = 'flex';
                setupTouchControls();
            }
            
            gameActive = true;
            initGame();
            gameLoop();
        }

        function setupTouchControls() {
            const leftBtn = document.getElementById('leftBtn');
            const rightBtn = document.getElementById('rightBtn');
            const jumpBtn = document.getElementById('jumpBtn');
            const attackBtn = document.getElementById('attackBtn');
            
            let touchState = { left: false, right: false };
            
            leftBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                touchState.left = true;
            });
            
            leftBtn.addEventListener('touchend', (e) => {
                e.preventDefault();
                touchState.left = false;
            });
            
            rightBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                touchState.right = true;
            });
            
            rightBtn.addEventListener('touchend', (e) => {
                e.preventDefault();
                touchState.right = false;
            });
            
            jumpBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                player.jump();
            });
            
            attackBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                if (player.attackCooldown <= 0) {
                    playerAttack();
                }
            });
            
            window.touchState = touchState;
        }

        // ===== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function initGame() {
            resizeCanvas();
            playerStats.health = 100;
            playerStats.score = 0;
            playerStats.kills = 0;
            playerStats.weaponsCollected = 1;
            playerStats.worldKills = 0;
            currentWorld = 1;
            bossActive = false;
            
            enemies = [];
            particles = [];
            healthOrbs = [];
            weaponDrops = [];
            
            updateUI();
            spawnEnemy();
        }

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        window.addEventListener('resize', resizeCanvas);

        // ===== Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
        const player = {
            x: 400,
            y: 400,
            width: 60,
            height: 100,
            speed: 6,
            velocityY: 0,
            isJumping: false,
            facingRight: true,
            attackCooldown: 0,
            
            update() {
                // Ø­Ø±ÙƒØ© Ø³Ù„Ø³Ø©
                if (deviceType === 'pc') {
                    if (keys['a'] || keys['arrowleft']) {
                        this.x -= this.speed;
                        this.facingRight = false;
                    }
                    if (keys['d'] || keys['arrowright']) {
                        this.x += this.speed;
                        this.facingRight = true;
                    }
                    if ((keys['w'] || keys['arrowup']) && !this.isJumping) {
                        this.velocityY = -18;
                        this.isJumping = true;
                        createJumpEffect();
                    }
                } else {
                    if (window.touchState?.left) {
                        this.x -= this.speed;
                        this.facingRight = false;
                    }
                    if (window.touchState?.right) {
                        this.x += this.speed;
                        this.facingRight = true;
                    }
                }
                
                // Ø¬Ø§Ø°Ø¨ÙŠØ©
                this.y += this.velocityY;
                this.velocityY += 0.8;
                
                // Ø£Ø±Ø¶
                if (this.y > canvas.height - 180) {
                    this.y = canvas.height - 180;
                    this.velocityY = 0;
                    this.isJumping = false;
                }
                
                // Ø­Ø¯ÙˆØ¯
                this.x = Math.max(this.width/2, Math.min(this.x, canvas.width - this.width/2));
                
                // ÙˆÙ‚Øª Ø§Ù„Ù‡Ø¬ÙˆÙ…
                if (this.attackCooldown > 0) this.attackCooldown--;
            }
        };

        // ===== Ø§Ù„ØªØ­ÙƒÙ… =====
        const keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
            if (e.key === ' ' && player.attackCooldown <= 0) {
                playerAttack();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });

        canvas.addEventListener('click', () => {
            if (player.attackCooldown <= 0) {
                playerAttack();
            }
        });

        // ===== Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ =====
        let enemies = [];
        let particles = [];
        let healthOrbs = [];
        let weaponDrops = [];

        // ===== Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø¯Ùˆ Ø­Ø³Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù… =====
        function spawnEnemy() {
            if (!gameActive || enemies.length >= 15 || bossActive) return;
            
            const enemyTypes = [
                { name: "Ø¬Ù†Ø¯ÙŠ", health: 50 + (currentWorld * 20), speed: 2 + (currentWorld * 0.3), size: 50, color: '#ff4757' },
                { name: "ÙˆØ­Ø´", health: 80 + (currentWorld * 30), speed: 1.5 + (currentWorld * 0.2), size: 70, color: '#ff9f43' },
                { name: "Ø³Ø§Ø­Ø±", health: 40 + (currentWorld * 15), speed: 2.5 + (currentWorld * 0.4), size: 45, color: '#00d2d3' }
            ];
            
            const type = Math.floor(Math.random() * enemyTypes.length);
            const enemy = enemyTypes[type];
            
            enemies.push({
                ...enemy,
                x: Math.random() > 0.5 ? -100 : canvas.width + 100,
                y: canvas.height - 180,
                originalY: canvas.height - 180,
                health: enemy.health,
                maxHealth: enemy.health,
                floatOffset: Math.random() * Math.PI * 2,
                floatSpeed: 0.02 + Math.random() * 0.03,
                isDead: false,
                deathTimer: 0
            });
            
            setTimeout(spawnEnemy, 1500 - (currentWorld * 200));
        }

        // ===== Ù‡Ø¬ÙˆÙ… Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
        function playerAttack() {
            player.attackCooldown = 20;
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‡Ø¬ÙˆÙ…
            createAttackEffect();
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¹Ø¯Ø§Ø¡ ÙÙŠ Ø§Ù„Ù…Ø¯Ù‰
            enemies.forEach((enemy, index) => {
                if (!enemy.isDead) {
                    const distance = Math.sqrt(
                        Math.pow(player.x - enemy.x, 2) + 
                        Math.pow(player.y - enemy.y, 2)
                    );
                    
                    if (distance < 120) {
                        const damage = weapons[playerStats.currentWeapon].damage;
                        enemy.health -= damage;
                        
                        // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¯Ù…
                        createBloodEffect(enemy.x, enemy.y, enemy.color);
                        
                        if (enemy.health <= 0) {
                            killEnemy(enemy, index);
                        }
                    }
                }
            });
        }

        // ===== Ù‚ØªÙ„ Ø§Ù„Ø¹Ø¯Ùˆ =====
        function killEnemy(enemy, index) {
            enemy.isDead = true;
            playerStats.kills++;
            playerStats.worldKills++;
            playerStats.score += 100 * currentWorld;
            
            // Ø¥Ø³Ù‚Ø§Ø· Ù‡ÙŠÙ„Ø« Ø£ÙˆØ±Ø¨
            if (Math.random() < 0.4) {
                createHealthOrb(enemy.x, enemy.y);
            }
            
            // Ø¥Ø³Ù‚Ø§Ø· Ø³Ù„Ø§Ø­ (ÙØ±ØµØ© 10%)
            if (Math.random() < 0.1 && playerStats.weaponsCollected < weapons.length) {
                createWeaponDrop(enemy.x, enemy.y);
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¹Ø§Ù„Ù… Ø§Ù„ØªØ§Ù„ÙŠ
            if (playerStats.worldKills >= playerStats.killsNeededForNextWorld && currentWorld < totalWorlds) {
                transitionToNextWorld();
            }
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ø¯Ùˆ
            setTimeout(() => {
                enemies.splice(index, 1);
            }, 1000);
            
            updateUI();
        }

        // ===== Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¹Ø§Ù„Ù… Ø§Ù„ØªØ§Ù„ÙŠ =====
        function transitionToNextWorld() {
            gameActive = false;
            document.getElementById('worldTransition').style.display = 'flex';
            
            setTimeout(() => {
                currentWorld++;
                playerStats.worldKills = 0;
                enemies = [];
                particles = [];
                
                document.getElementById('worldTransition').style.display = 'none';
                gameActive = true;
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø£Ø®ÙŠØ±ØŒ Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³
                if (currentWorld > totalWorlds) {
                    startBossFight();
                } else {
                    spawnEnemy();
                }
                
                updateUI();
            }, 3000);
        }

        // ===== Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ =====
        const boss = {
            health: 5000,
            maxHealth: 5000,
            x: canvas.width / 2,
            y: 200,
            size: 150,
            attackCooldown: 0
        };

        function startBossFight() {
            bossActive = true;
            boss.health = 5000;
            document.getElementById('bossFight').style.display = 'flex';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙˆØ³
            enemies = [{
                x: canvas.width / 2,
                y: 200,
                size: 150,
                health: boss.health,
                maxHealth: boss.health,
                color: '#ff4757',
                isBoss: true,
                isDead: false
            }];
            
            updateBossUI();
        }

        function updateBossUI() {
            const healthPercent = (boss.health / boss.maxHealth) * 100;
            document.getElementById('bossHealthFill').style.width = `${healthPercent}%`;
        }

        // ===== ØªØ£Ø«ÙŠØ±Ø§Øª =====
        function createJumpEffect() {
            for (let i = 0; i < 15; i++) {
                particles.push({
                    x: player.x,
                    y: player.y + player.height/2,
                    size: Math.random() * 6 + 3,
                    speedX: (Math.random() - 0.5) * 8,
                    speedY: Math.random() * -4 - 2,
                    color: '#00a8ff',
                    life: 40
                });
            }
        }

        function createAttackEffect() {
            const angle = player.facingRight ? 0 : Math.PI;
            
            for (let i = 0; i < 20; i++) {
                particles.push({
                    x: player.x + (player.facingRight ? 60 : -60),
                    y: player.y,
                    size: Math.random() * 8 + 4,
                    speedX: Math.cos(angle) * 12 + (Math.random() - 0.5) * 4,
                    speedY: (Math.random() - 0.5) * 8,
                    color: weapons[playerStats.currentWeapon].color,
                    life: 30
                });
            }
        }

        function createBloodEffect(x, y, color) {
            for (let i = 0; i < 15; i++) {
                particles.push({
                    x: x,
                    y: y,
                    size: Math.random() * 8 + 4,
                    speedX: (Math.random() - 0.5) * 10,
                    speedY: (Math.random() - 0.5) * 10,
                    color: color,
                    life: 50
                });
            }
        }

        function createHealthOrb(x, y) {
            healthOrbs.push({
                x: x,
                y: y,
                size: 15,
                color: '#00ff88',
                collected: false
            });
        }

        function createWeaponDrop(x, y) {
            weaponDrops.push({
                x: x,
                y: y,
                weaponIndex: Math.min(playerStats.weaponsCollected, weapons.length - 1),
                collected: false
            });
            playerStats.weaponsCollected++;
        }

        // ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© =====
        function updateUI() {
            const healthPercent = (playerStats.health / playerStats.maxHealth) * 100;
            document.getElementById('healthFill').style.width = `${healthPercent}%`;
            document.getElementById('scoreValue').textContent = playerStats.score;
            document.getElementById('killsValue').textContent = playerStats.kills;
            document.getElementById('weaponsValue').textContent = playerStats.weaponsCollected;
            document.getElementById('worldLevel').textContent = currentWorld;
            
            if (bossActive) {
                updateBossUI();
            }
        }

        // ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function update() {
            if (!gameActive) return;
            
            player.update();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
            enemies.forEach(enemy => {
                if (!enemy.isDead) {
                    // Ø­Ø±ÙƒØ© ØªØ·ÙÙˆ
                    const time = Date.now() * 0.001;
                    enemy.y = enemy.originalY + Math.sin(time * enemy.floatSpeed + enemy.floatOffset) * 20;
                    
                    // Ø­Ø±ÙƒØ© Ù†Ø­Ùˆ Ø§Ù„Ù„Ø§Ø¹Ø¨
                    const dx = player.x - enemy.x;
                    const dy = player.y - enemy.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance > 60) {
                        enemy.x += (dx / distance) * enemy.speed;
                    }
                    
                    // Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø¹Ø¯Ùˆ
                    if (distance < 80 && !bossActive) {
                        playerStats.health -= 2;
                        createBloodEffect(player.x, player.y, '#ff4757');
                    }
                    
                    // Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø¨ÙˆØ³
                    if (enemy.isBoss && distance < 200) {
                        if (enemy.attackCooldown <= 0) {
                            playerStats.health -= 20;
                            enemy.attackCooldown = 60;
                            createBloodEffect(player.x, player.y, '#ff0000');
                        }
                        enemy.attackCooldown--;
                    }
                } else {
                    enemy.deathTimer++;
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª
            particles.forEach((particle, index) => {
                particle.x += particle.speedX;
                particle.y += particle.speedY;
                particle.speedY += 0.2;
                particle.life--;
                
                if (particle.life <= 0) {
                    particles.splice(index, 1);
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„ØµØ­Ø©
            healthOrbs.forEach((orb, index) => {
                const dx = player.x - orb.x;
                const dy = player.y - orb.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 100 || orb.collected) {
                    orb.x += (dx / distance) * 5;
                    orb.y += (dy / distance) * 5;
                    orb.collected = true;
                }
                
                if (distance < 30) {
                    playerStats.health = Math.min(playerStats.maxHealth, playerStats.health + 25);
                    healthOrbs.splice(index, 1);
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø³Ù„Ø­Ø© Ø§Ù„Ù…Ø³Ù‚Ø·Ø©
            weaponDrops.forEach((drop, index) => {
                const dx = player.x - drop.x;
                const dy = player.y - drop.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 100 || drop.collected) {
                    drop.x += (dx / distance) * 4;
                    drop.y += (dy / distance) * 4;
                    drop.collected = true;
                }
                
                if (distance < 40) {
                    playerStats.currentWeapon = drop.weaponIndex;
                    weaponDrops.splice(index, 1);
                    createAttackEffect();
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« ØµØ­Ø© Ø§Ù„Ø¨ÙˆØ³
            if (bossActive && enemies[0]) {
                boss.health = enemies[0].health;
                if (boss.health <= 0) {
                    endBossFight();
                }
            }
            
            updateUI();
            
            // ÙØ­Øµ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©
            if (playerStats.health <= 0) {
                endGame();
            }
        }

        // ===== Ù†Ù‡Ø§ÙŠØ© Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ =====
        function endBossFight() {
            bossActive = false;
            document.getElementById('bossFight').style.display = 'none';
            playerStats.score += 10000;
            alert(currentLanguage === 'ar' ? 'ğŸ‰ Ø§Ù†ØªØµØ±Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ³! Ù„Ù‚Ø¯ Ø£Ù†Ù‚Ø°Øª Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„!' : 'ğŸ‰ You defeated the boss! You saved Battle Lands!');
            showStats();
        }

        // ===== Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function endGame() {
            gameActive = false;
            const t = translations[currentLanguage];
            if (confirm(`${t.gameOver}\n\n${t.score}: ${playerStats.score}\n${t.kills}: ${playerStats.kills}\n\n${t.restart}?`)) {
                initGame();
                gameActive = true;
            }
        }

        // ===== Ø§Ù„Ø±Ø³Ù… =====
        function draw() {
            // Ø®Ù„ÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù…
            const worldColor = worldNames[currentWorld]?.color || '#0a0a2e';
            ctx.fillStyle = worldColor + '20';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Ø£Ø±Ø¶
            const groundGradient = ctx.createLinearGradient(0, canvas.height - 180, 0, canvas.height);
            groundGradient.addColorStop(0, worldColor + '80');
            groundGradient.addColorStop(1, '#000000');
            ctx.fillStyle = groundGradient;
            ctx.fillRect(0, canvas.height - 180, canvas.width, 180);
            
            // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø±Ø¶
            ctx.fillStyle = worldColor + '40';
            for (let i = 0; i < canvas.width; i += 60) {
                ctx.fillRect(i, canvas.height - 180, 40, 15);
            }
            
            // Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„ØµØ­Ø©
            healthOrbs.forEach(orb => {
                ctx.save();
                ctx.shadowColor = orb.color;
                ctx.shadowBlur = 20;
                
                ctx.fillStyle = orb.color;
                ctx.beginPath();
                ctx.arc(orb.x, orb.y, orb.size, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = 'white';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('â¤ï¸', orb.x, orb.y);
                
                ctx.restore();
            });
            
            // Ø£Ø³Ù„Ø­Ø© Ù…Ø³Ù‚Ø·Ø©
            weaponDrops.forEach(drop => {
                const weapon = weapons[drop.weaponIndex];
                ctx.save();
                ctx.shadowColor = weapon.color;
                ctx.shadowBlur = 15;
                
                ctx.fillStyle = weapon.color;
                ctx.beginPath();
                ctx.arc(drop.x, drop.y, 20, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = 'white';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('âš”ï¸', drop.x, drop.y);
                
                ctx.restore();
            });
            
            // Ø¬Ø²ÙŠØ¦Ø§Øª
            particles.forEach(particle => {
                ctx.globalAlpha = particle.life / 50;
                ctx.fillStyle = particle.color;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
            
            // Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
            enemies.forEach(enemy => {
                if (!enemy.isDead) {
                    ctx.save();
                    
                    // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¨ÙˆØ³
                    if (enemy.isBoss) {
                        ctx.shadowColor = '#ff0000';
                        ctx.shadowBlur = 30;
                    }
                    
                    // Ø§Ù„Ø¬Ø³Ù…
                    ctx.fillStyle = enemy.color;
                    ctx.beginPath();
                    ctx.arc(enemy.x, enemy.y, enemy.size / 2, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Ø§Ù„Ø¹ÙŠÙˆÙ†
                    ctx.fillStyle = 'white';
                    ctx.beginPath();
                    ctx.arc(enemy.x - 15, enemy.y - 10, 6, 0, Math.PI * 2);
                    ctx.arc(enemy.x + 15, enemy.y - 10, 6, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Ø´Ø±ÙŠØ· Ø§Ù„ØµØ­Ø©
                    const healthPercent = enemy.health / enemy.maxHealth;
                    ctx.fillStyle = '#ff4757';
                    ctx.fillRect(enemy.x - 40, enemy.y - 60, 80, 8);
                    ctx.fillStyle = '#00ff88';
                    ctx.fillRect(enemy.x - 40, enemy.y - 60, 80 * healthPercent, 8);
                    
                    ctx.restore();
                }
            });
            
            // Ø§Ù„Ù„Ø§Ø¹Ø¨
            drawPlayer();
        }

        function drawPlayer() {
            ctx.save();
            
            // ØªÙˆÙ‡Ø¬ Ø§Ù„Ù„Ø§Ø¹Ø¨
            ctx.shadowColor = '#00a8ff';
            ctx.shadowBlur = 20;
            
            // Ø§Ù„Ø¬Ø³Ù…
            const bodyGradient = ctx.createLinearGradient(
                player.x - player.width/2, player.y - player.height/2,
                player.x - player.width/2, player.y + player.height/2
            );
            bodyGradient.addColorStop(0, '#3742fa');
            bodyGradient.addColorStop(1, '#1e90ff');
            
            ctx.fillStyle = bodyGradient;
            ctx.beginPath();
            ctx.roundRect(
                player.x - player.width/2,
                player.y - player.height/2,
                player.width,
                player.height,
                15
            );
            ctx.fill();
            
            // Ø§Ù„Ø¯Ø±ÙˆØ¹
            ctx.fillStyle = '#2f3542';
            ctx.fillRect(player.x - player.width/2 - 10, player.y - player.height/2, 10, player.height);
            ctx.fillRect(player.x + player.width/2, player.y - player.height/2, 10, player.height);
            
            // Ø§Ù„Ø±Ø£Ø³
            ctx.fillStyle = '#ffa502';
            ctx.beginPath();
            ctx.arc(player.x, player.y - player.height/2 - 15, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø§Ù„Ø¹ÙŠÙˆÙ†
            ctx.fillStyle = 'white';
            const eyeOffset = player.facingRight ? 5 : -5;
            ctx.beginPath();
            ctx.arc(player.x + eyeOffset, player.y - player.height/2 - 18, 5, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø§Ù„Ø³Ù„Ø§Ø­
            const weapon = weapons[playerStats.currentWeapon];
            ctx.fillStyle = weapon.color;
            const weaponX = player.facingRight ? player.x + player.width/2 : player.x - player.width/2 - 30;
            ctx.fillRect(weaponX, player.y - 10, 30, 8);
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø³Ù„Ø§Ø­
            ctx.shadowColor = weapon.color;
            ctx.shadowBlur = 15;
            ctx.fillRect(weaponX, player.y - 10, 30, 8);
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‡Ø¬ÙˆÙ…
            if (player.attackCooldown > 0) {
                ctx.strokeStyle = weapon.color;
                ctx.lineWidth = 3;
                ctx.beginPath();
                const attackX = player.facingRight ? player.x + 80 : player.x - 80;
                ctx.arc(attackX, player.y, 40, 0, Math.PI * 2);
                ctx.stroke();
            }
            
            ctx.restore();
        }

        // ===== Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function gameLoop() {
            if (gameActive) {
                update();
                draw();
                requestAnimationFrame(gameLoop);
            }
        }

        // ===== ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© =====
        function showWeapons() {
            alert(currentLanguage === 'ar' 
                ? `Ù„Ø¯ÙŠÙƒ ${playerStats.weaponsCollected} Ù…Ù† Ø£ØµÙ„ 300 Ø³Ù„Ø§Ø­!\n\nØ§Ù„Ø³Ù„Ø§Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${weapons[playerStats.currentWeapon].name}\nØ§Ù„Ø¶Ø±Ø±: ${weapons[playerStats.currentWeapon].damage}`
                : `You have ${playerStats.weaponsCollected} out of 300 weapons!\n\nCurrent Weapon: ${weapons[playerStats.currentWeapon].name}\nDamage: ${weapons[playerStats.currentWeapon].damage}`
            );
        }

        function showStats() {
            alert(currentLanguage === 'ar'
                ? `ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ${playerName}:\n\nğŸ† Ø§Ù„Ù†Ù‚Ø§Ø·: ${playerStats.score}\nğŸ‘¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø§Ù„Ù…Ù‚ØªÙˆÙ„ÙŠÙ†: ${playerStats.kills}\nğŸ—¡ï¸ Ø§Ù„Ø£Ø³Ù„Ø­Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©: ${playerStats.weaponsCollected}/300\nğŸŒ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ: ${currentWorld}`
                : `ğŸ“Š ${playerName}'s Stats:\n\nğŸ† Score: ${playerStats.score}\nğŸ‘¹ Enemies Killed: ${playerStats.kills}\nğŸ—¡ï¸ Weapons Collected: ${playerStats.weaponsCollected}/300\nğŸŒ Current World: ${currentWorld}`
            );
        }

        // ===== Ø¯Ø§Ù„Ø© roundRect =====
        CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, r) {
            if (w < 2 * r) r = w / 2;
            if (h < 2 * r) r = h / 2;
            this.beginPath();
            this.moveTo(x + r, y);
            this.arcTo(x + w, y, x + w, y + h, r);
            this.arcTo(x + w, y + h, x, y + h, r);
            this.arcTo(x, y + h, x, y, r);
            this.arcTo(x, y, x + w, y, r);
            this.closePath();
            return this;
        };

        // ===== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ© =====
        resizeCanvas();
        updateLanguage();
    </script>
</body>
</html><!DOCTYPE html>
<html lang="ar" id="htmlElement">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Battle Lands - Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #ff4655;
            --secondary-color: #0f1923;
            --accent-color: #1f2d3d;
            --gold-color: #ffd700;
            --text-color: #ffffff;
            --arabic-font: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --english-font: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }

        body {
            background: radial-gradient(circle at center, #0a0a2e 0%, #000 100%);
            color: var(--text-color);
            font-family: var(--arabic-font);
            overflow: hidden;
            height: 100vh;
            position: relative;
        }

        /* Ø§Ù„Ù„ØºØ© */
        .language-selector {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            display: flex;
            gap: 10px;
        }

        .lang-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--primary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
        }

        .lang-btn:hover {
            background: var(--primary-color);
            transform: scale(1.05);
        }

        .lang-btn.active {
            background: var(--primary-color);
            box-shadow: 0 0 20px var(--primary-color);
        }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        .welcome-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #0f1923 0%, #1a1a2e 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            backdrop-filter: blur(20px);
        }

        .game-logo {
            font-size: 5em;
            background: linear-gradient(45deg, #ff4655, #ffd700);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            text-align: center;
            text-shadow: 0 0 30px rgba(255, 70, 85, 0.5);
        }

        .player-name-input {
            width: 300px;
            padding: 15px;
            font-size: 1.2em;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid var(--primary-color);
            border-radius: 10px;
            color: white;
            text-align: center;
            margin: 20px 0;
            backdrop-filter: blur(10px);
        }

        .player-name-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .start-game-btn {
            padding: 15px 40px;
            font-size: 1.3em;
            background: linear-gradient(45deg, #ff4655, #ff7b00);
            border: none;
            color: white;
            border-radius: 25px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
            font-weight: bold;
        }

        .start-game-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px #ff4655;
        }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
        .main-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1538481199705-c710c4e965fc?q=80&w=2065');
            background-size: cover;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9998;
        }

        .menu-overlay {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(15, 25, 35, 0.9);
            backdrop-filter: blur(5px);
        }

        .menu-content {
            position: relative;
            z-index: 2;
            text-align: center;
            max-width: 800px;
        }

        .menu-title {
            font-size: 4em;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #ffd700, #ff4655);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(255, 70, 85, 0.3);
        }

        .player-welcome {
            font-size: 1.5em;
            color: #ffd700;
            margin-bottom: 40px;
        }

        .menu-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 40px;
        }

        .menu-option {
            background: linear-gradient(135deg, rgba(31, 45, 61, 0.8), rgba(15, 25, 35, 0.9));
            padding: 25px;
            border-radius: 15px;
            border: 2px solid var(--primary-color);
            cursor: pointer;
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .menu-option:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(255, 70, 85, 0.3);
            border-color: #ffd700;
        }

        .option-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: #ffd700;
        }

        /* ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© */
        .game-ui {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9997;
            display: none;
        }

        .player-info {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(15, 25, 35, 0.8);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid var(--primary-color);
            backdrop-filter: blur(10px);
            min-width: 200px;
        }

        .player-name-display {
            color: #ffd700;
            font-size: 1.3em;
            margin-bottom: 10px;
        }

        .health-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .health-bar {
            flex: 1;
            height: 20px;
            background: rgba(255, 70, 85, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .health-fill {
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, #ff4655, #00ff88);
            border-radius: 10px;
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .world-info {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(15, 25, 35, 0.8);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid #00a8ff;
            backdrop-filter: blur(10px);
            text-align: center;
            min-width: 150px;
        }

        .world-title {
            color: #00a8ff;
            font-size: 1.2em;
            margin-bottom: 5px;
        }

        .world-level {
            color: #ffd700;
            font-size: 1.5em;
            font-weight: bold;
        }

        .game-stats {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 15px;
        }

        .stat-box {
            background: rgba(15, 25, 35, 0.8);
            padding: 15px;
            border-radius: 15px;
            border: 2px solid;
            backdrop-filter: blur(10px);
            text-align: center;
            min-width: 120px;
        }

        .score-box { border-color: #ffd700; }
        .kills-box { border-color: #ff4655; }
        .weapons-box { border-color: #00a8ff; }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }

        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù„Ø¬ÙˆØ§Ù„ */
        .mobile-controls {
            position: absolute;
            bottom: 20px;
            right: 20px;
            display: none;
            gap: 15px;
            pointer-events: auto;
        }

        .control-btn {
            width: 70px;
            height: 70px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8em;
            color: white;
            cursor: pointer;
            border: 2px solid rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(10px);
            transition: all 0.1s;
        }

        .control-btn:active {
            transform: scale(0.9);
            background: rgba(255, 255, 255, 0.3);
        }

        /* Ø§Ù„ÙƒÙ†ÙØ§Ø³ */
        #gameCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            display: none;
        }

        /* Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø¹ÙˆØ§Ù„Ù… */
        .world-transition {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            font-size: 3em;
            text-align: center;
            animation: transitionPulse 2s infinite;
        }

        @keyframes transitionPulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Ø¨ÙˆØ³ Ø§Ù„Ø¹Ø§Ù„Ù… */
        .boss-fight {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            text-align: center;
        }

        .boss-title {
            font-size: 4em;
            color: #ff4655;
            margin-bottom: 20px;
            text-shadow: 0 0 30px #ff4655;
        }

        .boss-health {
            width: 80%;
            height: 40px;
            background: rgba(255, 70, 85, 0.3);
            border-radius: 20px;
            overflow: hidden;
            margin: 30px auto;
            border: 3px solid #ff4655;
        }

        .boss-health-fill {
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, #ff4655, #ff0000);
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <!-- Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù„ØºØ© -->
    <div class="language-selector">
        <button class="lang-btn active" onclick="changeLanguage('ar')">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
        <button class="lang-btn" onclick="changeLanguage('en')">English</button>
    </div>

    <!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ -->
    <div class="welcome-screen" id="welcomeScreen">
        <div class="game-logo">âš”ï¸ Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„ âš”ï¸</div>
        <input type="text" class="player-name-input" id="playerNameInput" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§...">
        <button class="start-game-btn" onclick="savePlayerName()">ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©</button>
    </div>

    <!-- Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="main-menu" id="mainMenu">
        <div class="menu-overlay"></div>
        <div class="menu-content">
            <h1 class="menu-title" id="menuTitle">Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„</h1>
            <div class="player-welcome" id="playerWelcome">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="playerNameDisplay">Ø§Ù„Ù…Ø­Ø§Ø±Ø¨</span>!</div>
            <div class="menu-options">
                <div class="menu-option" onclick="startGame('pc')">
                    <div class="option-icon">ğŸ’»</div>
                    <div id="pcOption">Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±</div>
                </div>
                <div class="menu-option" onclick="startGame('mobile')">
                    <div class="option-icon">ğŸ“±</div>
                    <div id="mobileOption">Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ</div>
                </div>
                <div class="menu-option" onclick="showWeapons()">
                    <div class="option-icon">ğŸ—¡ï¸</div>
                    <div id="weaponsOption">Ø§Ù„Ø£Ø³Ù„Ø­Ø© (300)</div>
                </div>
                <div class="menu-option" onclick="showStats()">
                    <div class="option-icon">ğŸ†</div>
                    <div id="statsOption">Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© -->
    <div class="game-ui" id="gameUI">
        <div class="player-info">
            <div class="player-name-display" id="gamePlayerName">Ø§Ù„Ù…Ø­Ø§Ø±Ø¨</div>
            <div class="health-container">
                <span>â¤ï¸</span>
                <div class="health-bar">
                    <div class="health-fill" id="healthFill"></div>
                </div>
            </div>
        </div>

        <div class="world-info">
            <div class="world-title" id="worldTitle">Ø§Ù„Ø¹Ø§Ù„Ù…</div>
            <div class="world-level" id="worldLevel">1</div>
        </div>

        <div class="game-stats">
            <div class="stat-box score-box">
                <div class="stat-value" id="scoreValue">0</div>
                <div class="stat-label" id="scoreLabel">Ø§Ù„Ù†Ù‚Ø§Ø·</div>
            </div>
            <div class="stat-box kills-box">
                <div class="stat-value" id="killsValue">0</div>
                <div class="stat-label" id="killsLabel">Ø§Ù„Ù‚ØªÙ„Ù‰</div>
            </div>
            <div class="stat-box weapons-box">
                <div class="stat-value" id="weaponsValue">1</div>
                <div class="stat-label" id="weaponsLabel">Ø§Ù„Ø£Ø³Ù„Ø­Ø©</div>
            </div>
        </div>

        <div class="mobile-controls" id="mobileControls">
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div class="control-btn" id="leftBtn">â—€</div>
                <div class="control-btn" id="rightBtn">â–¶</div>
            </div>
            <div style="display: flex; flex-direction: column; gap: 15px;">
                <div class="control-btn" id="jumpBtn">â¬†</div>
                <div class="control-btn" id="attackBtn">âš”</div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø¹ÙˆØ§Ù„Ù… -->
    <div class="world-transition" id="worldTransition">
        <div>
            <div id="transitionText">Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯...</div>
            <div style="font-size: 0.5em; margin-top: 20px;" id="transitionSubtext">Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø£ØµØ¨Ø­ÙˆØ§ Ø£Ù‚ÙˆÙ‰!</div>
        </div>
    </div>

    <!-- Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ -->
    <div class="boss-fight" id="bossFight">
        <div>
            <div class="boss-title" id="bossTitle">ğŸ‘¹ Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ğŸ‘¹</div>
            <div style="font-size: 1.5em; color: #ffd700; margin: 20px 0;" id="bossName">Ù…Ù„Ùƒ Ø§Ù„Ø¸Ù„Ø§Ù…</div>
            <div class="boss-health">
                <div class="boss-health-fill" id="bossHealthFill"></div>
            </div>
            <div style="font-size: 1.2em; color: #00a8ff;" id="bossInfo">Ø§Ø¶Ø±Ø¨ Ø¨Ù‚ÙˆØ© Ù„ØªÙ†ØªØµØ±!</div>
        </div>
    </div>

    <canvas id="gameCanvas"></canvas>

    <script>
        // ===== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„ØºØ© =====
        const translations = {
            ar: {
                gameTitle: "Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„",
                enterName: "Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§...",
                startGame: "ğŸš€ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù…ØºØ§Ù…Ø±Ø©",
                welcome: "Ù…Ø±Ø­Ø¨Ø§Ù‹",
                pcOption: "Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ Ø§Ù„ÙƒÙ…Ø¨ÙŠÙˆØªØ±",
                mobileOption: "Ø§Ù„Ø¹Ø¨ Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ",
                weaponsOption: "Ø§Ù„Ø£Ø³Ù„Ø­Ø© (300)",
                statsOption: "Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª",
                world: "Ø§Ù„Ø¹Ø§Ù„Ù…",
                score: "Ø§Ù„Ù†Ù‚Ø§Ø·",
                kills: "Ø§Ù„Ù‚ØªÙ„Ù‰",
                weapons: "Ø§Ù„Ø£Ø³Ù„Ø­Ø©",
                transition: "Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯...",
                transitionSub: "Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø£ØµØ¨Ø­ÙˆØ§ Ø£Ù‚ÙˆÙ‰!",
                bossTitle: "ğŸ‘¹ Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© ğŸ‘¹",
                bossInfo: "Ø§Ø¶Ø±Ø¨ Ø¨Ù‚ÙˆØ© Ù„ØªÙ†ØªØµØ±!",
                gameOver: "Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!",
                restart: "ğŸ”„ Ø§Ù„Ø¹Ø¨ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰"
            },
            en: {
                gameTitle: "Battle Lands",
                enterName: "Enter your name here...",
                startGame: "ğŸš€ Start Adventure",
                welcome: "Welcome",
                pcOption: "Play on PC",
                mobileOption: "Play on Mobile",
                weaponsOption: "Weapons (300)",
                statsOption: "Statistics",
                world: "World",
                score: "Score",
                kills: "Kills",
                weapons: "Weapons",
                transition: "Transitioning to New World...",
                transitionSub: "Enemies have become stronger!",
                bossTitle: "ğŸ‘¹ Final Boss Battle ğŸ‘¹",
                bossInfo: "Strike hard to win!",
                gameOver: "Game Over!",
                restart: "ğŸ”„ Play Again"
            }
        };

        // ===== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        let currentLanguage = 'ar';
        let playerName = "Ø§Ù„Ù…Ø­Ø§Ø±Ø¨";
        let gameActive = false;
        let deviceType = 'pc';
        let currentWorld = 1;
        let totalWorlds = 5;
        let bossActive = false;

        // ===== Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
        const playerStats = {
            score: 0,
            kills: 0,
            weaponsCollected: 1,
            health: 100,
            maxHealth: 100,
            currentWeapon: 0,
            worldKills: 0,
            killsNeededForNextWorld: 50
        };

        // ===== Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø¹ÙˆØ§Ù„Ù… =====
        const worldNames = {
            1: { ar: "Ø¹Ø§Ù„Ù… Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©", en: "Starter World", color: "#00a8ff" },
            2: { ar: "Ø¹Ø§Ù„Ù… Ø§Ù„ØºØ§Ø¨Ø§Øª", en: "Forest World", color: "#00b894" },
            3: { ar: "Ø¹Ø§Ù„Ù… Ø§Ù„Ø¬Ù„ÙŠØ¯", en: "Ice World", color: "#00cec9" },
            4: { ar: "Ø¹Ø§Ù„Ù… Ø§Ù„Ù†Ø§Ø±", en: "Fire World", color: "#ff7675" },
            5: { ar: "Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ", en: "Final World", color: "#a29bfe" }
        };

        // ===== 300 Ø³Ù„Ø§Ø­ =====
        const weapons = Array.from({ length: 300 }, (_, i) => ({
            id: i + 1,
            name: `Ø³Ù„Ø§Ø­ ${i + 1}`,
            damage: 10 + Math.floor(i / 10),
            rarity: Math.min(5, Math.floor(i / 60) + 1),
            color: getWeaponColor(Math.floor(i / 60))
        }));

        function getWeaponColor(tier) {
            const colors = ['#ffffff', '#4CAF50', '#2196F3', '#9C27B0', '#FF9800', '#FFD700'];
            return colors[Math.min(tier, colors.length - 1)];
        }

        // ===== ØªØºÙŠÙŠØ± Ø§Ù„Ù„ØºØ© =====
        function changeLanguage(lang) {
            currentLanguage = lang;
            document.getElementById('htmlElement').setAttribute('lang', lang);
            document.getElementById('htmlElement').setAttribute('dir', lang === 'ar' ? 'rtl' : 'ltr');
            
            // ØªØ­Ø¯ÙŠØ« Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù„ØºØ©
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            updateLanguage();
        }

        function updateLanguage() {
            const t = translations[currentLanguage];
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ
            document.querySelector('.game-logo').textContent = `âš”ï¸ ${t.gameTitle} âš”ï¸`;
            document.getElementById('playerNameInput').placeholder = t.enterName;
            document.querySelector('.start-game-btn').textContent = t.startGame;
            document.getElementById('menuTitle').textContent = t.gameTitle;
            document.getElementById('playerWelcome').textContent = `${t.welcome}ØŒ <span id="playerNameDisplay">${playerName}</span>!`;
            document.getElementById('pcOption').textContent = t.pcOption;
            document.getElementById('mobileOption').textContent = t.mobileOption;
            document.getElementById('weaponsOption').textContent = t.weaponsOption;
            document.getElementById('statsOption').textContent = t.statsOption;
            document.getElementById('worldTitle').textContent = t.world;
            document.getElementById('scoreLabel').textContent = t.score;
            document.getElementById('killsLabel').textContent = t.kills;
            document.getElementById('weaponsLabel').textContent = t.weapons;
            document.getElementById('transitionText').textContent = t.transition;
            document.getElementById('transitionSubtext').textContent = t.transitionSub;
            document.getElementById('bossTitle').textContent = t.bossTitle;
            document.getElementById('bossInfo').textContent = t.bossInfo;
        }

        // ===== Ø­ÙØ¸ Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
        function savePlayerName() {
            const nameInput = document.getElementById('playerNameInput');
            playerName = nameInput.value.trim() || "Ø§Ù„Ù…Ø­Ø§Ø±Ø¨";
            
            document.getElementById('welcomeScreen').style.display = 'none';
            document.getElementById('mainMenu').style.display = 'flex';
            document.getElementById('playerNameDisplay').textContent = playerName;
            document.getElementById('gamePlayerName').textContent = playerName;
        }

        // ===== Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function startGame(device) {
            deviceType = device;
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('gameCanvas').style.display = 'block';
            document.getElementById('gameUI').style.display = 'block';
            
            if (device === 'mobile') {
                document.getElementById('mobileControls').style.display = 'flex';
                setupTouchControls();
            }
            
            gameActive = true;
            initGame();
            gameLoop();
        }

        function setupTouchControls() {
            const leftBtn = document.getElementById('leftBtn');
            const rightBtn = document.getElementById('rightBtn');
            const jumpBtn = document.getElementById('jumpBtn');
            const attackBtn = document.getElementById('attackBtn');
            
            let touchState = { left: false, right: false };
            
            leftBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                touchState.left = true;
            });
            
            leftBtn.addEventListener('touchend', (e) => {
                e.preventDefault();
                touchState.left = false;
            });
            
            rightBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                touchState.right = true;
            });
            
            rightBtn.addEventListener('touchend', (e) => {
                e.preventDefault();
                touchState.right = false;
            });
            
            jumpBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                player.jump();
            });
            
            attackBtn.addEventListener('touchstart', (e) => {
                e.preventDefault();
                if (player.attackCooldown <= 0) {
                    playerAttack();
                }
            });
            
            window.touchState = touchState;
        }

        // ===== ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function initGame() {
            resizeCanvas();
            playerStats.health = 100;
            playerStats.score = 0;
            playerStats.kills = 0;
            playerStats.weaponsCollected = 1;
            playerStats.worldKills = 0;
            currentWorld = 1;
            bossActive = false;
            
            enemies = [];
            particles = [];
            healthOrbs = [];
            weaponDrops = [];
            
            updateUI();
            spawnEnemy();
        }

        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }

        window.addEventListener('resize', resizeCanvas);

        // ===== Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
        const player = {
            x: 400,
            y: 400,
            width: 60,
            height: 100,
            speed: 6,
            velocityY: 0,
            isJumping: false,
            facingRight: true,
            attackCooldown: 0,
            
            update() {
                // Ø­Ø±ÙƒØ© Ø³Ù„Ø³Ø©
                if (deviceType === 'pc') {
                    if (keys['a'] || keys['arrowleft']) {
                        this.x -= this.speed;
                        this.facingRight = false;
                    }
                    if (keys['d'] || keys['arrowright']) {
                        this.x += this.speed;
                        this.facingRight = true;
                    }
                    if ((keys['w'] || keys['arrowup']) && !this.isJumping) {
                        this.velocityY = -18;
                        this.isJumping = true;
                        createJumpEffect();
                    }
                } else {
                    if (window.touchState?.left) {
                        this.x -= this.speed;
                        this.facingRight = false;
                    }
                    if (window.touchState?.right) {
                        this.x += this.speed;
                        this.facingRight = true;
                    }
                }
                
                // Ø¬Ø§Ø°Ø¨ÙŠØ©
                this.y += this.velocityY;
                this.velocityY += 0.8;
                
                // Ø£Ø±Ø¶
                if (this.y > canvas.height - 180) {
                    this.y = canvas.height - 180;
                    this.velocityY = 0;
                    this.isJumping = false;
                }
                
                // Ø­Ø¯ÙˆØ¯
                this.x = Math.max(this.width/2, Math.min(this.x, canvas.width - this.width/2));
                
                // ÙˆÙ‚Øª Ø§Ù„Ù‡Ø¬ÙˆÙ…
                if (this.attackCooldown > 0) this.attackCooldown--;
            }
        };

        // ===== Ø§Ù„ØªØ­ÙƒÙ… =====
        const keys = {};
        document.addEventListener('keydown', (e) => {
            keys[e.key.toLowerCase()] = true;
            if (e.key === ' ' && player.attackCooldown <= 0) {
                playerAttack();
            }
        });
        
        document.addEventListener('keyup', (e) => {
            keys[e.key.toLowerCase()] = false;
        });

        canvas.addEventListener('click', () => {
            if (player.attackCooldown <= 0) {
                playerAttack();
            }
        });

        // ===== Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ =====
        let enemies = [];
        let particles = [];
        let healthOrbs = [];
        let weaponDrops = [];

        // ===== Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ø¯Ùˆ Ø­Ø³Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù… =====
        function spawnEnemy() {
            if (!gameActive || enemies.length >= 15 || bossActive) return;
            
            const enemyTypes = [
                { name: "Ø¬Ù†Ø¯ÙŠ", health: 50 + (currentWorld * 20), speed: 2 + (currentWorld * 0.3), size: 50, color: '#ff4757' },
                { name: "ÙˆØ­Ø´", health: 80 + (currentWorld * 30), speed: 1.5 + (currentWorld * 0.2), size: 70, color: '#ff9f43' },
                { name: "Ø³Ø§Ø­Ø±", health: 40 + (currentWorld * 15), speed: 2.5 + (currentWorld * 0.4), size: 45, color: '#00d2d3' }
            ];
            
            const type = Math.floor(Math.random() * enemyTypes.length);
            const enemy = enemyTypes[type];
            
            enemies.push({
                ...enemy,
                x: Math.random() > 0.5 ? -100 : canvas.width + 100,
                y: canvas.height - 180,
                originalY: canvas.height - 180,
                health: enemy.health,
                maxHealth: enemy.health,
                floatOffset: Math.random() * Math.PI * 2,
                floatSpeed: 0.02 + Math.random() * 0.03,
                isDead: false,
                deathTimer: 0
            });
            
            setTimeout(spawnEnemy, 1500 - (currentWorld * 200));
        }

        // ===== Ù‡Ø¬ÙˆÙ… Ø§Ù„Ù„Ø§Ø¹Ø¨ =====
        function playerAttack() {
            player.attackCooldown = 20;
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‡Ø¬ÙˆÙ…
            createAttackEffect();
            
            // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ø¹Ø¯Ø§Ø¡ ÙÙŠ Ø§Ù„Ù…Ø¯Ù‰
            enemies.forEach((enemy, index) => {
                if (!enemy.isDead) {
                    const distance = Math.sqrt(
                        Math.pow(player.x - enemy.x, 2) + 
                        Math.pow(player.y - enemy.y, 2)
                    );
                    
                    if (distance < 120) {
                        const damage = weapons[playerStats.currentWeapon].damage;
                        enemy.health -= damage;
                        
                        // ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¯Ù…
                        createBloodEffect(enemy.x, enemy.y, enemy.color);
                        
                        if (enemy.health <= 0) {
                            killEnemy(enemy, index);
                        }
                    }
                }
            });
        }

        // ===== Ù‚ØªÙ„ Ø§Ù„Ø¹Ø¯Ùˆ =====
        function killEnemy(enemy, index) {
            enemy.isDead = true;
            playerStats.kills++;
            playerStats.worldKills++;
            playerStats.score += 100 * currentWorld;
            
            // Ø¥Ø³Ù‚Ø§Ø· Ù‡ÙŠÙ„Ø« Ø£ÙˆØ±Ø¨
            if (Math.random() < 0.4) {
                createHealthOrb(enemy.x, enemy.y);
            }
            
            // Ø¥Ø³Ù‚Ø§Ø· Ø³Ù„Ø§Ø­ (ÙØ±ØµØ© 10%)
            if (Math.random() < 0.1 && playerStats.weaponsCollected < weapons.length) {
                createWeaponDrop(enemy.x, enemy.y);
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¹Ø§Ù„Ù… Ø§Ù„ØªØ§Ù„ÙŠ
            if (playerStats.worldKills >= playerStats.killsNeededForNextWorld && currentWorld < totalWorlds) {
                transitionToNextWorld();
            }
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ø¯Ùˆ
            setTimeout(() => {
                enemies.splice(index, 1);
            }, 1000);
            
            updateUI();
        }

        // ===== Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø¹Ø§Ù„Ù… Ø§Ù„ØªØ§Ù„ÙŠ =====
        function transitionToNextWorld() {
            gameActive = false;
            document.getElementById('worldTransition').style.display = 'flex';
            
            setTimeout(() => {
                currentWorld++;
                playerStats.worldKills = 0;
                enemies = [];
                particles = [];
                
                document.getElementById('worldTransition').style.display = 'none';
                gameActive = true;
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø£Ø®ÙŠØ±ØŒ Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³
                if (currentWorld > totalWorlds) {
                    startBossFight();
                } else {
                    spawnEnemy();
                }
                
                updateUI();
            }, 3000);
        }

        // ===== Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ =====
        const boss = {
            health: 5000,
            maxHealth: 5000,
            x: canvas.width / 2,
            y: 200,
            size: 150,
            attackCooldown: 0
        };

        function startBossFight() {
            bossActive = true;
            boss.health = 5000;
            document.getElementById('bossFight').style.display = 'flex';
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙˆØ³
            enemies = [{
                x: canvas.width / 2,
                y: 200,
                size: 150,
                health: boss.health,
                maxHealth: boss.health,
                color: '#ff4757',
                isBoss: true,
                isDead: false
            }];
            
            updateBossUI();
        }

        function updateBossUI() {
            const healthPercent = (boss.health / boss.maxHealth) * 100;
            document.getElementById('bossHealthFill').style.width = `${healthPercent}%`;
        }

        // ===== ØªØ£Ø«ÙŠØ±Ø§Øª =====
        function createJumpEffect() {
            for (let i = 0; i < 15; i++) {
                particles.push({
                    x: player.x,
                    y: player.y + player.height/2,
                    size: Math.random() * 6 + 3,
                    speedX: (Math.random() - 0.5) * 8,
                    speedY: Math.random() * -4 - 2,
                    color: '#00a8ff',
                    life: 40
                });
            }
        }

        function createAttackEffect() {
            const angle = player.facingRight ? 0 : Math.PI;
            
            for (let i = 0; i < 20; i++) {
                particles.push({
                    x: player.x + (player.facingRight ? 60 : -60),
                    y: player.y,
                    size: Math.random() * 8 + 4,
                    speedX: Math.cos(angle) * 12 + (Math.random() - 0.5) * 4,
                    speedY: (Math.random() - 0.5) * 8,
                    color: weapons[playerStats.currentWeapon].color,
                    life: 30
                });
            }
        }

        function createBloodEffect(x, y, color) {
            for (let i = 0; i < 15; i++) {
                particles.push({
                    x: x,
                    y: y,
                    size: Math.random() * 8 + 4,
                    speedX: (Math.random() - 0.5) * 10,
                    speedY: (Math.random() - 0.5) * 10,
                    color: color,
                    life: 50
                });
            }
        }

        function createHealthOrb(x, y) {
            healthOrbs.push({
                x: x,
                y: y,
                size: 15,
                color: '#00ff88',
                collected: false
            });
        }

        function createWeaponDrop(x, y) {
            weaponDrops.push({
                x: x,
                y: y,
                weaponIndex: Math.min(playerStats.weaponsCollected, weapons.length - 1),
                collected: false
            });
            playerStats.weaponsCollected++;
        }

        // ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© =====
        function updateUI() {
            const healthPercent = (playerStats.health / playerStats.maxHealth) * 100;
            document.getElementById('healthFill').style.width = `${healthPercent}%`;
            document.getElementById('scoreValue').textContent = playerStats.score;
            document.getElementById('killsValue').textContent = playerStats.kills;
            document.getElementById('weaponsValue').textContent = playerStats.weaponsCollected;
            document.getElementById('worldLevel').textContent = currentWorld;
            
            if (bossActive) {
                updateBossUI();
            }
        }

        // ===== ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function update() {
            if (!gameActive) return;
            
            player.update();
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
            enemies.forEach(enemy => {
                if (!enemy.isDead) {
                    // Ø­Ø±ÙƒØ© ØªØ·ÙÙˆ
                    const time = Date.now() * 0.001;
                    enemy.y = enemy.originalY + Math.sin(time * enemy.floatSpeed + enemy.floatOffset) * 20;
                    
                    // Ø­Ø±ÙƒØ© Ù†Ø­Ùˆ Ø§Ù„Ù„Ø§Ø¹Ø¨
                    const dx = player.x - enemy.x;
                    const dy = player.y - enemy.y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance > 60) {
                        enemy.x += (dx / distance) * enemy.speed;
                    }
                    
                    // Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø¹Ø¯Ùˆ
                    if (distance < 80 && !bossActive) {
                        playerStats.health -= 2;
                        createBloodEffect(player.x, player.y, '#ff4757');
                    }
                    
                    // Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø¨ÙˆØ³
                    if (enemy.isBoss && distance < 200) {
                        if (enemy.attackCooldown <= 0) {
                            playerStats.health -= 20;
                            enemy.attackCooldown = 60;
                            createBloodEffect(player.x, player.y, '#ff0000');
                        }
                        enemy.attackCooldown--;
                    }
                } else {
                    enemy.deathTimer++;
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¬Ø²ÙŠØ¦Ø§Øª
            particles.forEach((particle, index) => {
                particle.x += particle.speedX;
                particle.y += particle.speedY;
                particle.speedY += 0.2;
                particle.life--;
                
                if (particle.life <= 0) {
                    particles.splice(index, 1);
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„ØµØ­Ø©
            healthOrbs.forEach((orb, index) => {
                const dx = player.x - orb.x;
                const dy = player.y - orb.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 100 || orb.collected) {
                    orb.x += (dx / distance) * 5;
                    orb.y += (dy / distance) * 5;
                    orb.collected = true;
                }
                
                if (distance < 30) {
                    playerStats.health = Math.min(playerStats.maxHealth, playerStats.health + 25);
                    healthOrbs.splice(index, 1);
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø³Ù„Ø­Ø© Ø§Ù„Ù…Ø³Ù‚Ø·Ø©
            weaponDrops.forEach((drop, index) => {
                const dx = player.x - drop.x;
                const dy = player.y - drop.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 100 || drop.collected) {
                    drop.x += (dx / distance) * 4;
                    drop.y += (dy / distance) * 4;
                    drop.collected = true;
                }
                
                if (distance < 40) {
                    playerStats.currentWeapon = drop.weaponIndex;
                    weaponDrops.splice(index, 1);
                    createAttackEffect();
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« ØµØ­Ø© Ø§Ù„Ø¨ÙˆØ³
            if (bossActive && enemies[0]) {
                boss.health = enemies[0].health;
                if (boss.health <= 0) {
                    endBossFight();
                }
            }
            
            updateUI();
            
            // ÙØ­Øµ Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø©
            if (playerStats.health <= 0) {
                endGame();
            }
        }

        // ===== Ù†Ù‡Ø§ÙŠØ© Ù…Ø¹Ø±ÙƒØ© Ø§Ù„Ø¨ÙˆØ³ =====
        function endBossFight() {
            bossActive = false;
            document.getElementById('bossFight').style.display = 'none';
            playerStats.score += 10000;
            alert(currentLanguage === 'ar' ? 'ğŸ‰ Ø§Ù†ØªØµØ±Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ³! Ù„Ù‚Ø¯ Ø£Ù†Ù‚Ø°Øª Ø£Ø±Ø§Ø¶ÙŠ Ø§Ù„Ù‚ØªØ§Ù„!' : 'ğŸ‰ You defeated the boss! You saved Battle Lands!');
            showStats();
        }

        // ===== Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function endGame() {
            gameActive = false;
            const t = translations[currentLanguage];
            if (confirm(`${t.gameOver}\n\n${t.score}: ${playerStats.score}\n${t.kills}: ${playerStats.kills}\n\n${t.restart}?`)) {
                initGame();
                gameActive = true;
            }
        }

        // ===== Ø§Ù„Ø±Ø³Ù… =====
        function draw() {
            // Ø®Ù„ÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ø¹Ø§Ù„Ù…
            const worldColor = worldNames[currentWorld]?.color || '#0a0a2e';
            ctx.fillStyle = worldColor + '20';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Ø£Ø±Ø¶
            const groundGradient = ctx.createLinearGradient(0, canvas.height - 180, 0, canvas.height);
            groundGradient.addColorStop(0, worldColor + '80');
            groundGradient.addColorStop(1, '#000000');
            ctx.fillStyle = groundGradient;
            ctx.fillRect(0, canvas.height - 180, canvas.width, 180);
            
            // ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø£Ø±Ø¶
            ctx.fillStyle = worldColor + '40';
            for (let i = 0; i < canvas.width; i += 60) {
                ctx.fillRect(i, canvas.height - 180, 40, 15);
            }
            
            // Ø£ÙˆØ±Ø§Ù‚ Ø§Ù„ØµØ­Ø©
            healthOrbs.forEach(orb => {
                ctx.save();
                ctx.shadowColor = orb.color;
                ctx.shadowBlur = 20;
                
                ctx.fillStyle = orb.color;
                ctx.beginPath();
                ctx.arc(orb.x, orb.y, orb.size, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = 'white';
                ctx.font = '20px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('â¤ï¸', orb.x, orb.y);
                
                ctx.restore();
            });
            
            // Ø£Ø³Ù„Ø­Ø© Ù…Ø³Ù‚Ø·Ø©
            weaponDrops.forEach(drop => {
                const weapon = weapons[drop.weaponIndex];
                ctx.save();
                ctx.shadowColor = weapon.color;
                ctx.shadowBlur = 15;
                
                ctx.fillStyle = weapon.color;
                ctx.beginPath();
                ctx.arc(drop.x, drop.y, 20, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = 'white';
                ctx.font = '16px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('âš”ï¸', drop.x, drop.y);
                
                ctx.restore();
            });
            
            // Ø¬Ø²ÙŠØ¦Ø§Øª
            particles.forEach(particle => {
                ctx.globalAlpha = particle.life / 50;
                ctx.fillStyle = particle.color;
                ctx.beginPath();
                ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                ctx.fill();
            });
            ctx.globalAlpha = 1;
            
            // Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡
            enemies.forEach(enemy => {
                if (!enemy.isDead) {
                    ctx.save();
                    
                    // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¨ÙˆØ³
                    if (enemy.isBoss) {
                        ctx.shadowColor = '#ff0000';
                        ctx.shadowBlur = 30;
                    }
                    
                    // Ø§Ù„Ø¬Ø³Ù…
                    ctx.fillStyle = enemy.color;
                    ctx.beginPath();
                    ctx.arc(enemy.x, enemy.y, enemy.size / 2, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Ø§Ù„Ø¹ÙŠÙˆÙ†
                    ctx.fillStyle = 'white';
                    ctx.beginPath();
                    ctx.arc(enemy.x - 15, enemy.y - 10, 6, 0, Math.PI * 2);
                    ctx.arc(enemy.x + 15, enemy.y - 10, 6, 0, Math.PI * 2);
                    ctx.fill();
                    
                    // Ø´Ø±ÙŠØ· Ø§Ù„ØµØ­Ø©
                    const healthPercent = enemy.health / enemy.maxHealth;
                    ctx.fillStyle = '#ff4757';
                    ctx.fillRect(enemy.x - 40, enemy.y - 60, 80, 8);
                    ctx.fillStyle = '#00ff88';
                    ctx.fillRect(enemy.x - 40, enemy.y - 60, 80 * healthPercent, 8);
                    
                    ctx.restore();
                }
            });
            
            // Ø§Ù„Ù„Ø§Ø¹Ø¨
            drawPlayer();
        }

        function drawPlayer() {
            ctx.save();
            
            // ØªÙˆÙ‡Ø¬ Ø§Ù„Ù„Ø§Ø¹Ø¨
            ctx.shadowColor = '#00a8ff';
            ctx.shadowBlur = 20;
            
            // Ø§Ù„Ø¬Ø³Ù…
            const bodyGradient = ctx.createLinearGradient(
                player.x - player.width/2, player.y - player.height/2,
                player.x - player.width/2, player.y + player.height/2
            );
            bodyGradient.addColorStop(0, '#3742fa');
            bodyGradient.addColorStop(1, '#1e90ff');
            
            ctx.fillStyle = bodyGradient;
            ctx.beginPath();
            ctx.roundRect(
                player.x - player.width/2,
                player.y - player.height/2,
                player.width,
                player.height,
                15
            );
            ctx.fill();
            
            // Ø§Ù„Ø¯Ø±ÙˆØ¹
            ctx.fillStyle = '#2f3542';
            ctx.fillRect(player.x - player.width/2 - 10, player.y - player.height/2, 10, player.height);
            ctx.fillRect(player.x + player.width/2, player.y - player.height/2, 10, player.height);
            
            // Ø§Ù„Ø±Ø£Ø³
            ctx.fillStyle = '#ffa502';
            ctx.beginPath();
            ctx.arc(player.x, player.y - player.height/2 - 15, 20, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø§Ù„Ø¹ÙŠÙˆÙ†
            ctx.fillStyle = 'white';
            const eyeOffset = player.facingRight ? 5 : -5;
            ctx.beginPath();
            ctx.arc(player.x + eyeOffset, player.y - player.height/2 - 18, 5, 0, Math.PI * 2);
            ctx.fill();
            
            // Ø§Ù„Ø³Ù„Ø§Ø­
            const weapon = weapons[playerStats.currentWeapon];
            ctx.fillStyle = weapon.color;
            const weaponX = player.facingRight ? player.x + player.width/2 : player.x - player.width/2 - 30;
            ctx.fillRect(weaponX, player.y - 10, 30, 8);
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ø³Ù„Ø§Ø­
            ctx.shadowColor = weapon.color;
            ctx.shadowBlur = 15;
            ctx.fillRect(weaponX, player.y - 10, 30, 8);
            
            // ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‡Ø¬ÙˆÙ…
            if (player.attackCooldown > 0) {
                ctx.strokeStyle = weapon.color;
                ctx.lineWidth = 3;
                ctx.beginPath();
                const attackX = player.facingRight ? player.x + 80 : player.x - 80;
                ctx.arc(attackX, player.y, 40, 0, Math.PI * 2);
                ctx.stroke();
            }
            
            ctx.restore();
        }

        // ===== Ø­Ù„Ù‚Ø© Ø§Ù„Ù„Ø¹Ø¨Ø© =====
        function gameLoop() {
            if (gameActive) {
                update();
                draw();
                requestAnimationFrame(gameLoop);
            }
        }

        // ===== ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© =====
        function showWeapons() {
            alert(currentLanguage === 'ar' 
                ? `Ù„Ø¯ÙŠÙƒ ${playerStats.weaponsCollected} Ù…Ù† Ø£ØµÙ„ 300 Ø³Ù„Ø§Ø­!\n\nØ§Ù„Ø³Ù„Ø§Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${weapons[playerStats.currentWeapon].name}\nØ§Ù„Ø¶Ø±Ø±: ${weapons[playerStats.currentWeapon].damage}`
                : `You have ${playerStats.weaponsCollected} out of 300 weapons!\n\nCurrent Weapon: ${weapons[playerStats.currentWeapon].name}\nDamage: ${weapons[playerStats.currentWeapon].damage}`
            );
        }

        function showStats() {
            alert(currentLanguage === 'ar'
                ? `ğŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ${playerName}:\n\nğŸ† Ø§Ù„Ù†Ù‚Ø§Ø·: ${playerStats.score}\nğŸ‘¹ Ø§Ù„Ø£Ø¹Ø¯Ø§Ø¡ Ø§Ù„Ù…Ù‚ØªÙˆÙ„ÙŠÙ†: ${playerStats.kills}\nğŸ—¡ï¸ Ø§Ù„Ø£Ø³Ù„Ø­Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©: ${playerStats.weaponsCollected}/300\nğŸŒ Ø§Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ: ${currentWorld}`
                : `ğŸ“Š ${playerName}'s Stats:\n\nğŸ† Score: ${playerStats.score}\nğŸ‘¹ Enemies Killed: ${playerStats.kills}\nğŸ—¡ï¸ Weapons Collected: ${playerStats.weaponsCollected}/300\nğŸŒ Current World: ${currentWorld}`
            );
        }

        // ===== Ø¯Ø§Ù„Ø© roundRect =====
        CanvasRenderingContext2D.prototype.roundRect = function(x, y, w, h, r) {
            if (w < 2 * r) r = w / 2;
            if (h < 2 * r) r = h / 2;
            this.beginPath();
            this.moveTo(x + r, y);
            this.arcTo(x + w, y, x + w, y + h, r);
            this.arcTo(x + w, y + h, x, y + h, r);
            this.arcTo(x, y + h, x, y, r);
            this.arcTo(x, y, x + w, y, r);
            this.closePath();
            return this;
        };

        // ===== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ© =====
        resizeCanvas();
        updateLanguage();
    </script>
</body>
</html>